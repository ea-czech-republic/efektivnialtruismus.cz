{% extends "base.html" %}

{% load wagtailcore_tags %}
{% load wagtailimages_tags %}
{% load i18n %}
{% load menu_tags %}
{% load static %}
{% load wagtailuserbar %}

{% block extra_css %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/eacr.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/theses.css' %}">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <script type="text/javascript">
        window.smartlook || (function (d) {
            var o = smartlook = function () {
                o.api.push(arguments)
            }, h = d.getElementsByTagName('head')[0];
            var c = d.createElement('script');
            o.api = new Array();
            c.async = true;
            c.type = 'text/javascript';
            c.charset = 'utf-8';
            c.src = 'https://rec.smartlook.com/recorder.js';
            h.appendChild(c);
        })(document);
        smartlook('init', '947692deb59845cf0334e3ca2faa61b6bbe5a12e');
    </script>

    <!-- Hotjar Tracking Code for www.effectivethesis.com -->
    <script>
        (function (h, o, t, j, a, r) {
            h.hj = h.hj || function () {
                (h.hj.q = h.hj.q || []).push(arguments)
            };
            h._hjSettings = {hjid: 739132, hjsv: 6};
            a = o.getElementsByTagName('head')[0];
            r = o.createElement('script');
            r.async = 1;
            r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
            a.appendChild(r);
        })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
    </script>
{% endblock %}

{% block extra_head %}
    <!-- Global site tag (gtag.js) - Google AdWords: 866290173 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-866290173"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'AW-866290173');
    </script>

    {% block for_conversion_head %}
        {# this is used in conversion.html #}
    {% endblock %}
{% endblock %}

{% block body_class %}template-thesisbase{% endblock %}

{% block base_content %}

    <div class="container">
        <div class="row" id="menu_bar">
            <div class="col-md-9 mb-3 pl-0">
                {% flat_menu handle="theses_menu" template="menus/theses_menu.html" %}
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                {% block content %}
                {% endblock %}
            </div>
        </div>

        <hr class="mt-5"/>
        <div class="row">
            <div class="col-md-9">
                <footer role="contentinfo">
                    {% flat_menu "theses_footer" template="menus/footer_menu.html" %}
                    <p class="copyright">
                        © 2017 <a href="">Efektivní Altruismus</a>.
                        <a href="http://github.com/ea-czech-republic/efektivnialtruismus.cz">Github EA ČR</a>
                        -
                        patches welcome.
                    </p>
                </footer>
            </div>
        </div>
    </div>


    <div id="feedback-main">
        <div id="feedback-div">
            <p>
                This is a brand new project run by volunteers, any suggestion how to improve it is very welcome!
            </p>
            <form action="" method="post" class="form" id="feedback-form1" name="form1"
                  enctype="multipart/form-data">
                {% csrf_token %}
                <p class="email">
                    <input name="contact_email" type="email" class="feedback-input"
                           id="feedback-email" placeholder="Your email (optional)"/>
                </p>


                <p class="text">
                    <textarea name="content" type="content" class="feedback-input"
                              id="feedback-comment" required
                              placeholder="Your feedback"></textarea>
                </p>

                <div class="feedback-submit">
                    <input type="submit" value="SEND" id="feedback-button-blue"/>
                    <div class="feedback-ease"></div>
                </div>
            </form>
        </div>
    </div>

    <button id="popup" class="feedback-button" onclick="toggle_visibility()">Give us feedback!</button>

    <div id="share">

        <!-- facebook -->
        <a class="facebook" href="https://www.facebook.com/share.php?u={{ page.full_url }}&title={{ page.title }}"
           target="blank"><i
                class="fa fa-facebook"></i></a>

        <!-- twitter -->
        <a class="twitter" href="https://twitter.com/intent/tweet?status={{ page.title }}+{{ page.full_url }}"
           target="blank"><i
                class="fa fa-twitter"></i></a>
        <!-- linkedin -->
        <a class="linkedin"
           href="https://www.linkedin.com/shareArticle?mini=true&url={{ page.full_url }}&title={{ page.title }}&source={{ page.full_url }}"
           target="blank"><i class="fa fa-linkedin"></i></a>

        <!-- google plus -->
        <a class="googleplus" href="https://plus.google.com/share?url={{ page.full_url }}" target="blank"><i
                class="fa fa-google-plus"></i></a>

        <!-- pinterest -->
        <a class="pinterest"
           href="https://pinterest.com/pin/create/bookmarklet/?url={{ page.full_url }}&is_video=false&description={{ page.title }}"
           target="blank"><i class="fa fa-pinterest-p"></i></a>


    </div>

    <script type="text/javascript" id="cookieinfo"
            src="//cookieinfoscript.com/js/cookieinfo.min.js"
            data-close-text="Got it!">
    </script>

{% endblock %}

{% block extra_js %}
    <script src="{% static "js/theses.js" %}"></script>

    <script>
        function toggle_visibility() {
            var e = document.getElementById('feedback-main');
            if (e.style.display == 'block')
                e.style.display = 'none';
            else {
                e.style.display = 'block';
                window.scrollTo(0, document.body.scrollHeight);
            }
        }

        $('#feedback-form1').submit(function (e) {
            e.preventDefault();
            var _data = $(this).serializeArray();
            $.ajax({
                type: 'POST',
                url: '/theses/feedback/',
                data: _data,
                headers: {
                    'X-CSRFToken': $("[name=csrfmiddlewaretoken]").val()
                },
                success: function (response) {
                    console.log(response);
                    $('#feedback-div').html(response['message']);
                },
                error: function (e, x, r) { // on error..
                    $('#feedback-div').html('Och! Something went wrong, sorry. Please use our contact page instead');
                }
            });
            $('#feedback-div').css('background-color', 'rgb(255, 255, 255)');
        });

    </script>

    {% block extra_js_2 %}
        <!-- Facebook Share Button -->
        <div id="fb-root"></div>
        <script>(function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = 'https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.12';
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));</script>
        <div class="fb-share-button mt-1 mb-2" data-href="http://effectivethesis.com/humanitys-impact-wild-animal-suffering/" data-layout="button" data-size="large" data-mobile-iframe="true"><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u={{ origin_url }}&title=My new thesis topic! {{ title }}" class="fb-xfbml-parse-ignore">Share</a></div>
    {% endblock %}

{% endblock %}

{% block google_analytics %}
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-77119148-3', 'auto');
        ga('send', 'pageview');
    </script>

{% endblock %}
